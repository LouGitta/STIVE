CREATE TABLE `utilisateur` (
  `id` int PRIMARY KEY NOT NULL AUTO_INCREMENT,
  `nom` varchar(50) DEFAULT null,
  `prenom` varchar(50) DEFAULT null,
  `mdp` varchar(50) DEFAULT null,
  `mail` varchar(50) DEFAULT null,
  `is_client` tinyint(1) DEFAULT 1,
  `is_admin` tinyint(1) DEFAULT 0
);

CREATE TABLE `produit` (
  `id` int PRIMARY KEY NOT NULL AUTO_INCREMENT,
  `nom` varchar(50) DEFAULT null,
  `prix` float DEFAULT null,
  `description` varchar(255) DEFAULT null,
  `annee` year DEFAULT null,
  `quantite_stock` int DEFAULT null,
  `reference` varchar(255) DEFAULT null,
  `fournisseur` varchar(255) DEFAULT null,
  `info` varchar(250) DEFAULT null,
  `maison` varchar(250) DEFAULT null,
  `famille` varchar(250) DEFAULT null,
  `region` varchar(250) DEFAULT null,
  `image` varchar(255) DEFAULT null
);

CREATE TABLE `commande` (
  `id` int PRIMARY KEY NOT NULL AUTO_INCREMENT,
  `reference_commande` varchar(255),
  `date_commande` date DEFAULT null,
  `utilisateur_id` int DEFAULT null,
  `quantite_commande` int DEFAULT null,
  `prix_commande` float DEFAULT null
);

CREATE TABLE `restock` (
  `id` int PRIMARY KEY NOT NULL AUTO_INCREMENT,
  `reference_commande` varchar(255),
  `produit_id` int NOT NULL,
  `date` date DEFAULT null,
  `quantite` int DEFAULT null,
  `prix` float DEFAULT null
);

CREATE TABLE `article` (
  `commande_id` int NOT NULL,
  `produit_id` int NOT NULL,
  `prix` float DEFAULT null,
  `quantite` int DEFAULT null,
  PRIMARY KEY (`commande_id`, `produit_id`)
);

CREATE INDEX `utilisateur_id` ON `commande` (`utilisateur_id`);

CREATE INDEX `produit_id` ON `article` (`produit_id`);

ALTER TABLE `article` ADD CONSTRAINT `article_ibfk_1` FOREIGN KEY (`commande_id`) REFERENCES `commande` (`id`);

ALTER TABLE `article` ADD CONSTRAINT `article_ibfk_2` FOREIGN KEY (`produit_id`) REFERENCES `produit` (`id`);

ALTER TABLE `commande` ADD CONSTRAINT `commande_ibfk_1` FOREIGN KEY (`utilisateur_id`) REFERENCES `utilisateur` (`id`);

ALTER TABLE `restock` ADD CONSTRAINT `restock_ibfk_1` FOREIGN KEY (`produit_id`) REFERENCES `produit` (`id`);
